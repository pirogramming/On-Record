<form method="POST" action="{% url 'diaries:friend_create' %}" enctype="multipart/form-data">
    {% csrf_token %}
    <p>
        <label>ì´ë¦„:</label>
        {{ form.name }}
    </p>
    <p>
        <label>ì¢…ë¥˜:</label>
        {{ form.kind }}
    </p>
    <p>
        <label>ì‚¬ì§„:</label>
        {{ form.image }}
    <p>
    <p>
        <label>ì„±ê²©:</label>
        <div id="personality-buttons">
            {% for personality in form.personal.field.queryset %}
                <button type="button" class="personality-btn" data-value="{{ personality.id }}">{{ personality.type }}</button>
            {% endfor %}
        </div>
    </p>
    
    <!-- ì‹¤ì œ ì„ íƒëœ ì„±ê²©ì„ ì €ì¥í•  input í•„ë“œ -->
    <input type="hidden" name="personal" id="selected-personalities">

    <p>
        <label>ì„±ë³„:</label>
        {{ form.gender }}
    </p>

    <p>
        <label>ë‚˜ì´:</label>
        {{ form.age }}
    </p>

    <input type="submit" value="ë°˜ë ¤ì¹œêµ¬ ë“±ë¡">
</form>

<script>
    document.addEventListener("DOMContentLoaded", function () {
        const buttons = document.querySelectorAll(".personality-btn");
        const selectedInput = document.getElementById("selected-personalities");

        let selectedValues = new Set();  // ì„ íƒëœ ì„±ê²© ì €ì¥

        buttons.forEach(button => {
            button.addEventListener("click", function (e) {
                e.preventDefault();
                const value = this.getAttribute("data-value");

                if (selectedValues.has(value)) {
                    selectedValues.delete(value);
                    this.classList.remove("selected");
                } else {
                    selectedValues.add(value);
                    this.classList.add("selected");
                }

                selectedInput.value = Array.from(selectedValues).join(",");  // ì„ íƒëœ ê°’ì„ ìˆ¨ê²¨ì§„ inputì— ì €ì¥
                console.log("ğŸ”¹ Hidden input value:", selectedInput.value);
            });
        });
    });
</script>

<style>
    .personality-btn {
        border: 1px solid #666;
        padding: 5px 10px;
        margin: 5px;
        background-color: white;
        cursor: pointer;
        border-radius: 15px;
    }

    .personality-btn.selected {
        background-color: #ffcc00;
    }
</style>